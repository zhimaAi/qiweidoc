{"version":3,"file":"js/199.4d4c44c2.js","mappings":"+TAmCeA,EAAAA,EAAAA,MAAf,MACMC,GAAcC,EAAAA,EAAAA,IAAI,MAExB,IAAIC,EAAgBA,CAACC,EAAMC,EAAOC,KAChB,KAAVD,EACAC,EAAS,IAAIC,MAAM,WACX,iBAAiBC,KAAKH,GAEvBA,EAAMI,OAAS,EACtBH,EAAS,IAAIC,MAAM,aACZF,EAAMI,OAAS,GACtBH,EAAS,IAAIC,MAAM,eAEQ,KAAvBG,EAASC,WACTV,EAAYI,MAAMO,eAAe,gBAErCN,KATAA,EAAS,IAAIC,MAAM,eAUvB,EAEAM,EAAeA,CAACT,EAAMC,EAAOC,KACf,KAAVD,EACAC,EAAS,IAAIC,MAAM,WACX,qDAAqDC,KAAKH,GAE3DA,EAAMI,OAAS,EACtBH,EAAS,IAAIC,MAAM,aACZF,EAAMI,OAAS,GACtBH,EAAS,IAAIC,MAAM,eAEnBN,EAAYI,MAAMO,eAAe,gBACjCN,KAPAA,EAAS,IAAIC,MAAM,6BAQvB,EAEAO,EAAqBA,CAACV,EAAMC,EAAOC,KACrB,KAAVD,EACAC,EAAS,IAAIC,MAAM,WACX,qDAAqDC,KAAKH,GAE3DA,EAAMI,OAAS,EACtBH,EAAS,IAAIC,MAAM,aACZF,EAAMI,OAAS,GACtBH,EAAS,IAAIC,MAAM,cACZF,IAAUK,EAASK,KAC1BT,EAAS,IAAIC,MAAM,YAEnBD,IARAA,EAAS,IAAIC,MAAM,6BASvB,EAGJ,MAAMG,GAAWM,EAAAA,EAAAA,IAAS,CACtBC,MAAO,GACPF,KAAM,GACNJ,UAAW,KAGTO,GAAQF,EAAAA,EAAAA,IAAS,CACnBC,MAAO,CAAC,CAAEE,UAAU,EAAMC,UAAWjB,EAAekB,QAAS,WAC7DN,KAAM,CAAC,CAAEI,UAAU,EAAMC,UAAWP,EAAcQ,QAAS,WAC3DV,UAAW,CAAC,CAAEQ,UAAU,EAAMC,UAAWN,EAAoBO,QAAS,aAQpEC,IALSN,EAAAA,EAAAA,IAAS,CACpBO,SAAU,CAAEC,KAAM,GAClBC,WAAY,CAAED,KAAM,MAGDtB,EAAAA,EAAAA,IAAI,KAErBwB,GAASC,EAAAA,EAAAA,KAAS,IACfL,EAAejB,MAGhBK,EAASO,OAASK,EAAejB,MAC1B,GAEJ,EALI,MAQfuB,EAAAA,EAAAA,KAAU,KACNC,GAAiB,IAGrB,MAAMA,EAAkBA,MACpBC,EAAAA,EAAAA,MAAiBC,MAAMC,IACfA,EAAIC,OACJvB,EAASO,MAAQe,EAAIC,KAAKC,QAC1BZ,EAAejB,MAAQ8B,KAAKC,MAAMD,KAAKE,UAAUL,EAAIC,KAAKC,UAC9D,GACF,EAGAI,EAAaA,KACfrC,EAAYI,MAAMkC,WAAWR,MAAMS,IAC/B,IAAIA,EAmBA,OAAO,EAnBA,CACP,IAAI,MAAEvB,EAAK,KAAEF,EAAI,UAAEJ,GAAcD,EAC7B+B,EAAS,CACTC,SAAUzB,EACV0B,SAAU5B,EACV6B,gBAAiBjC,IAErBkC,EAAAA,EAAAA,IAAYJ,GAAQV,MAAMC,IACJ,WAAdA,EAAIc,SACJC,EAAAA,GAAQC,QAAQ,QAEhBtC,EAASK,KAAO,GAChBL,EAASC,UAAY,IAIzBqB,EAAIiB,eAAiBF,EAAAA,GAAQG,MAAMlB,EAAIiB,cAAc,GAE7D,CAEA,GACF,E,64CC/IN,MAAME,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://zmwk_session_archive/./src/views/systemctl/account.vue","webpack://zmwk_session_archive/./src/views/systemctl/account.vue?08e6"],"sourcesContent":["<template>\n    <MainLayout title=\"账号管理\">\n        <div class=\"zm-main-content account\">\n            <div class=\"title\">\n                请设置登录账号及密码\n            </div>\n            <a-form class=\"mt24\" ref=\"ruleFormRef\" :model=\"ruleForm\" :rules=\"rules\">\n                <a-form-item name=\"login\" label=\"登录账号\">\n                    <a-input placeholder=\"请输入登录账号\" v-model:value=\"ruleForm.login\" allowClear />\n                </a-form-item>\n                <a-form-item name=\"pass\" :label=\"his_id != '' ? '新密码' : '设置密码'\">\n                    <a-input-password  autocomplete=\"\" :placeholder=\"his_id != '' ? '请输入新密码' : '请输入设置密码'\" v-model:value=\"ruleForm.pass\" allowClear />\n                </a-form-item>\n                <a-form-item name=\"checkPass\" :label=\"his_id != '' ? '确认新密码' : '确认密码'\">\n                    <a-input-password  autocomplete=\"\" :placeholder=\"his_id != '' ? '再次输入新密码' : '再次输入设置密码'\" v-model:value=\"ruleForm.checkPass\" allowClear />\n                </a-form-item>\n\n                <a-form-item>\n                    <a-button type=\"primary\" @click=\"submitForm()\" style=\"margin-top: 24px; margin-left: 138px;\">\n                        保存\n                        <!-- 确认修改 -->\n                    </a-button>\n                </a-form-item>\n            </a-form>\n        </div>\n    </MainLayout>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, reactive } from 'vue'\nimport { useRouter } from 'vue-router'\nimport MainLayout from \"@/components/mainLayout.vue\";\nimport { message } from 'ant-design-vue';\nimport { getCurrentUser, saveAccount } from \"@/api/auth-login\";\n\nconst router = useRouter()\nconst ruleFormRef = ref(null)\n\nlet validateLogin = (rule, value, callback) => {\n    if (value === '') {\n        callback(new Error('账号不能为空'))\n    } else if (!/^[a-zA-Z0-9]+$/.test(value)) {\n        callback(new Error('账号只能包含英文和数字'))\n    } else if (value.length < 6) {\n        callback(new Error('账号最少6个字符'))\n    } else if (value.length > 32) {\n        callback(new Error('账号最多32个字符'))\n    } else {\n        if (ruleForm.checkPass !== '') {\n            ruleFormRef.value.validateFields('checkSetPass')\n        }\n        callback()\n    }\n}\nlet validatePass = (rule, value, callback) => {\n    if (value === '') {\n        callback(new Error('密码不能为空'))\n    } else if (!/^[a-zA-Z0-9_`~!@#$%^&*()\\-=_+\\[\\]{}|;':\",.<>\\/?]+$/.test(value)) {\n        callback(new Error('密码只能包含英文、数字、下划线以及键盘上的特殊符号'))\n    } else if (value.length < 6) {\n        callback(new Error('密码最少6个字符'))\n    } else if (value.length > 32) {\n        callback(new Error('密码最多32个字符'))\n    } else {\n        ruleFormRef.value.validateFields('checkSetPass')\n        callback()\n    }\n}\nlet cvalidateCheckPass = (rule, value, callback) => {\n    if (value === '') {\n        callback(new Error('密码不能为空'))\n    } else if (!/^[a-zA-Z0-9_`~!@#$%^&*()\\-=_+\\[\\]{}|;':\",.<>\\/?]+$/.test(value)) {\n        callback(new Error('密码只能包含英文、数字、下划线以及键盘上的特殊符号'))\n    } else if (value.length < 6) {\n        callback(new Error('密码最少6个字符'))\n    } else if (value.length > 32) {\n        callback(new Error('密码最多32个字符'))\n    } else if (value !== ruleForm.pass) {\n        callback(new Error('两次密码不一致'))\n    } else {\n        callback()\n    }\n}\n\nconst ruleForm = reactive({\n    login: '',\n    pass: '',\n    checkPass: ''\n})\n\nconst rules = reactive({\n    login: [{ required: true, validator: validateLogin, trigger: 'change' }],\n    pass: [{ required: true, validator: validatePass, trigger: 'change' }],\n    checkPass: [{ required: true, validator: cvalidateCheckPass, trigger: 'change' }]\n})\n\nconst layout = reactive({\n    labelCol: { span: 2 },\n    wrapperCol: { span: 7 }\n})\n\nconst his_login_name = ref('')\n\nconst his_id = computed(() => {\n    if (!his_login_name.value) {\n        return ''\n    }\n    if (ruleForm.login != his_login_name.value) {\n        return ''\n    }\n    return 1\n})\n\nonMounted(() => {\n    getLoginAccount()\n})\n\nconst getLoginAccount = () => {\n    getCurrentUser().then((res) => {\n        if (res.data) {\n            ruleForm.login = res.data.account\n            his_login_name.value = JSON.parse(JSON.stringify(res.data.account))\n        }\n    })\n}\n\nconst submitForm = () => {\n    ruleFormRef.value.validate().then((valid) => {\n        if (valid) {\n            let { login, pass, checkPass } = ruleForm\n            let params = {\n                username: login,\n                password: pass,\n                repeat_password: checkPass\n            }\n            saveAccount(params).then((res) => {\n                if (res.status == 'success') {\n                    message.success('操作成功')\n                    // 刷新当前页面\n                    ruleForm.pass = ''\n                    ruleForm.checkPass = ''\n                    // router.go(0)\n                    // return\n                }\n                res.error_message && message.error(res.error_message)\n            })\n        } else {\n            return false\n        }\n    })\n}\n\n</script>\n\n<style scoped lang=\"less\">\n.account {\n    min-height: calc(100vh - 128px);\n    background: #fff;\n    padding: 0;\n    font-family: \"PingFang SC\";\n\n    .title {\n        display: flex;\n        width: 100%;\n        padding: 12px var(---0, 0) 12px var(---24, 24px);\n        flex-direction: column;\n        align-items: flex-start;\n        border-radius: 2px 2px var(---0, 0) var(---0, 0);\n        border-bottom: 1px solid var(--07, #F0F0F0);\n        background: #FFF;\n        color: #262626;\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 600;\n        line-height: 22px;\n    }\n\n    :deep(.ant-input-affix-wrapper) {\n        width: 360px;\n        border-radius: 2px;\n    }\n\n    :deep(.ant-form-item-label) {\n        min-width: 138px;\n    }\n\n\n    :deep(.ant-form-item-required::before) {\n        display: none !important;\n    }\n}\n</style>\n","import script from \"./account.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./account.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./account.vue?vue&type=style&index=0&id=f79d6ca8&scoped=true&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f79d6ca8\"]])\n\nexport default __exports__"],"names":["useRouter","ruleFormRef","ref","validateLogin","rule","value","callback","Error","test","length","ruleForm","checkPass","validateFields","validatePass","cvalidateCheckPass","pass","reactive","login","rules","required","validator","trigger","his_login_name","labelCol","span","wrapperCol","his_id","computed","onMounted","getLoginAccount","getCurrentUser","then","res","data","account","JSON","parse","stringify","submitForm","validate","valid","params","username","password","repeat_password","saveAccount","status","message","success","error_message","error","__exports__"],"sourceRoot":""}