{"version":3,"file":"js/186.2c2a1b51.js","mappings":"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","sources":["webpack://zmwk_session_archive/./src/components/loadingBox.vue","webpack://zmwk_session_archive/./src/components/loadingBox.vue?2acc","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue","webpack://zmwk_session_archive/./src/views/systemctl/authConfig.vue?829f"],"sourcesContent":["<template>\n    <div class=\"loading-box\">\n        <a-spin />\n    </div>\n</template>\n\n<script setup>\n</script>\n\n<style scoped lang=\"less\">\n.loading-box {\n    position: absolute;\n    width: 48px;\n    height: 48px;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n    text-align: center;\n}\n</style>\n","import { render } from \"./loadingBox.vue?vue&type=template&id=3d53ffb8&scoped=true\"\nconst script = {}\n\nimport \"./loadingBox.vue?vue&type=style&index=0&id=3d53ffb8&scoped=true&lang=less\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3d53ffb8\"]])\n\nexport default __exports__","<template>\n    <MainLayout title=\"会话存档配置信息\">\n        <div class=\"zm-main-box\">\n            <LoadingBox v-if=\"loading\"/>\n            <a-form\n                v-else\n                :label-col=\"{ span: 6 }\"\n                :wrapper-col=\"{ span: 10 }\"\n                autocomplete=\"off\"\n            >\n                <div class=\"form-block\">\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">基础信息</div>\n                        <div class=\"form-block-content\">\n                            <a-form-item label=\"企业ID\">\n                                <div class=\"c595959\">{{ formState.id }}</div>\n                            </a-form-item>\n                            <a-form-item label=\"自建应用ID\">\n                                <div class=\"c595959\">{{ formState.agent_id }}</div>\n                            </a-form-item>\n                            <template v-if=\"baseInfoEdit\">\n                                <a-form-item label=\"自建应用密钥\">\n                                    <a-input v-model:value=\"formState.agent_secret\" placeholder=\"请输入自建应用密钥\"/>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button class=\"mr8\" @click=\"editBaseInfoCancel\">取 消</a-button>\n                                    <a-button type=\"primary\" @click=\"editBaseInfo\" :loading=\"baseSaving\">保 存\n                                    </a-button>\n                                </a-form-item>\n                            </template>\n                            <template v-else>\n                                <a-form-item label=\"自建应用密钥\">\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.agent_secret) }}</div>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button type=\"primary\" @click=\"baseInfoEdit = true\">修 改</a-button>\n                                </a-form-item>\n                            </template>\n                        </div>\n                    </div>\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">将以下信息复制并填入到企业微信后台</div>\n                        <div class=\"form-block-content\">\n                            <a-form-item label=\"加密公钥\" class=\"label-height-unset\">\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_public_key)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.chat_public_key) }}\n                                </div>\n                            </a-form-item>\n                            <a-form-item label=\"加密私钥\" class=\"label-height-unset\">\n                                <div class=\"c595959 zm-pointer\" @click=\"copyText(formState.chat_private_key)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.chat_private_key, 80) }}\n                                </div>\n                            </a-form-item>\n                        </div>\n                    </div>\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">将以下信息复制到企微后台-应用管理-接收消息服务器中</div>\n                        <div class=\"form-block-content\">\n                            <a-form-item label=\"URL\" class=\"label-height-unset\">\n                                <div class=\"zm-pointer\" @click=\"copyText(formState.url)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ formState.url }}\n                                </div>\n                            </a-form-item>\n                            <a-form-item label=\"token\" class=\"label-height-unset\">\n                                <div class=\"zm-pointer\" @click=\"copyText(formState.callback_event_token)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.callback_event_token) }}\n                                </div>\n                            </a-form-item>\n                            <a-form-item label=\"encodingAESSKey\" class=\"label-height-unset\">\n                                <div class=\"zm-pointer\" @click=\"copyText(formState.callback_event_aes_key)\">\n                                    <div><a>点击复制</a></div>\n                                    {{ maskStringByPercentage(formState.callback_event_aes_key) }}\n                                </div>\n                            </a-form-item>\n                        </div>\n                    </div>\n                    <div class=\"form-block-item\">\n                        <div class=\"form-block-title\">将企业微信后台会话存档配置页面的信息复制粘贴到下框中</div>\n                        <div class=\"form-block-content\">\n                            <template v-if=\"sessionInfoEdit\">\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\n                                    <a-input v-model:value=\"formState.chat_secret\" placeholder=\"请输入会话存档密钥\"/>\n                                </a-form-item>\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\n                                    <a-input-number\n                                        style=\"width: 100%;\"\n                                        :precision=\"0\"\n                                        v-model:value=\"formState.chat_public_key_version\"\n                                        placeholder=\"请输入公钥版本号\"/>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button class=\"mr8\" @click=\"editSessionInfoCancel\">取 消</a-button>\n                                    <a-button type=\"primary\" @click=\"editSessionInfo\" :loading=\"sessionSaving\">保 存\n                                    </a-button>\n                                </a-form-item>\n                            </template>\n                            <template v-else>\n                                <a-form-item label=\"会话存档密钥\" name=\"corp_id\">\n                                    <div class=\"c595959\">{{ maskStringByPercentage(formState.chat_secret) }}</div>\n                                </a-form-item>\n                                <a-form-item label=\"公钥版本号\" name=\"corp_id\">\n                                    <div class=\"c595959\">{{ formState.chat_public_key_version }}</div>\n                                </a-form-item>\n                                <a-form-item :wrapper-col=\"{ span: 10, offset: 6}\">\n                                    <a-button type=\"primary\" @click=\"sessionInfoEdit = true\">修 改</a-button>\n                                </a-form-item>\n                            </template>\n                        </div>\n                    </div>\n                </div>\n            </a-form>\n        </div>\n    </MainLayout>\n</template>\n\n<script setup>\nimport {onMounted, ref, reactive, computed} from 'vue';\nimport {useStore} from 'vuex';\nimport {message} from 'ant-design-vue';\nimport MainLayout from \"@/components/mainLayout.vue\";\nimport {getCurrentCorp, getEventToken, setCurrentCorp} from \"@/api/auth-login\";\nimport {copyObj, copyText, maskStringByPercentage} from \"@/utils/tools\";\nimport LoadingBox from \"@/components/loadingBox.vue\";\n\nconst store = useStore()\nconst loading = ref(true)\nconst baseInfoEdit = ref(false)\nconst sessionInfoEdit = ref(false)\nconst baseSaving = ref(false)\nconst sessionSaving = ref(false)\nconst formStateDefault = ref({})\nconst formState = ref({\n    id: '',\n    agent_id: '',\n    agent_secret: '',\n    chat_public_key: '',\n    chat_private_key: '',\n    chat_public_key_version: '',\n    chat_secret: '',\n    callback_event_token: '',\n    callback_event_aes_key: '',\n    url: '',\n})\n\nconst corpId = computed(() => {\n    return store.getters.getCorpId\n})\n\nonMounted(() => {\n    init()\n})\n\nconst init = async () => {\n    loading.value = true\n    try {\n        await loadCorpInfo()\n    } catch (e) {\n        console.log('Err:', e)\n    }\n    loading.value = false\n}\n\nconst loadCorpInfo = async () => {\n    const {data} = await getCurrentCorp({\n        show_config: true\n    })\n    formState.value = data || {}\n    formState.value.url = window.location.origin + '/openpush/qw/' + corpId.value\n    formStateDefault.value = copyObj(formState.value)\n}\n\nconst editBaseInfo = () => {\n    if (baseInfoEdit.value) {\n        try {\n            baseSaving.value = true\n            formState.value.agent_secret = formState.value.agent_secret.trim()\n            if (!formState.value.agent_secret) {\n                throw '请输入自建应用密钥'\n            }\n            setCurrentCorp({\n                agent_secret: formState.value.agent_secret,\n            }).then(() => {\n                message.success('已保存')\n                baseInfoEdit.value = !baseInfoEdit.value\n                formStateDefault.value.agent_secret = formState.value.agent_secret\n            }).finally(() => {\n                baseSaving.value = false\n            })\n        } catch (e) {\n            baseSaving.value = false\n            message.error(e)\n        }\n    }\n}\n\nconst editBaseInfoCancel = () => {\n    baseInfoEdit.value = false\n    formState.value = copyObj(formStateDefault.value)\n}\n\nconst editSessionInfo = () => {\n    if (sessionInfoEdit.value) {\n        try {\n            sessionSaving.value = true\n            formState.value.chat_secret = formState.value.chat_secret.trim()\n            if (!formState.value.chat_secret) {\n                throw '请输入会话存档密钥'\n            }\n            if (!formState.value.chat_public_key_version) {\n                throw '请输入公钥版本号'\n            }\n            setCurrentCorp({\n                chat_secret: formState.value.chat_secret,\n                chat_public_key_version: formState.value.chat_public_key_version\n            }).then(() => {\n                message.success('已保存')\n                sessionInfoEdit.value = !sessionInfoEdit.value\n                formStateDefault.value.chat_secret = formState.value.chat_secret\n                formStateDefault.value.chat_public_key_version = formState.value.chat_public_key_version\n            }).finally(() => {\n                sessionSaving.value = false\n            })\n        } catch (e) {\n            sessionSaving.value = false\n            message.error(e)\n        }\n    }\n}\n\nconst editSessionInfoCancel = () => {\n    sessionInfoEdit.value = false\n    formState.value = copyObj(formStateDefault.value)\n}\n</script>\n\n<style scoped lang=\"less\">\n.zm-main-box {\n    background: #FFF;\n    padding-bottom: 40px;\n    min-height: calc(100vh - 120px);\n\n    :deep(.label-height-unset .ant-form-item-label >label ) {\n        height: unset;\n    }\n\n    .form-block {\n        .form-block-title {\n            color: #262626;\n            font-size: 14px;\n            font-weight: 600;\n            padding: 12px 24px;\n            border-bottom: 1px solid #F0F0F0;\n            margin-bottom: 16px;\n        }\n    }\n\n    .c595959 {\n        color: #595959;\n        word-break: break-all;\n    }\n}\n</style>\n","import script from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./authConfig.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./authConfig.vue?vue&type=style&index=0&id=6997c851&scoped=true&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6997c851\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_a_spin","script","__exports__","render","store","useStore","loading","ref","baseInfoEdit","sessionInfoEdit","baseSaving","sessionSaving","formStateDefault","formState","id","agent_id","agent_secret","chat_public_key","chat_private_key","chat_public_key_version","chat_secret","callback_event_token","callback_event_aes_key","url","corpId","computed","getters","getCorpId","onMounted","init","async","value","loadCorpInfo","e","console","log","data","getCurrentCorp","show_config","window","location","origin","copyObj","editBaseInfo","trim","setCurrentCorp","then","message","success","finally","error","editBaseInfoCancel","editSessionInfo","editSessionInfoCancel"],"sourceRoot":""}