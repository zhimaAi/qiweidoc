"use strict";(self["webpackChunkzmwk_session_archive"]=self["webpackChunkzmwk_session_archive"]||[]).push([[508],{6010:function(a,e,t){t.d(e,{A:function(){return o}});var n=t(6768),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},s=l,r=t(4827);function u(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})))),n.forEach((function(e){d(a,e,t[e])}))}return a}function d(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var i=function(a,e){var t=u({},a,e.attrs);return(0,n.bF)(r.A,u({},t,{icon:s}),null)};i.displayName="RedoOutlined",i.inheritAttrs=!1;var o=i},7875:function(a,e,t){t.d(e,{HN:function(){return u},LB:function(){return o},RJ:function(){return s},Xj:function(){return r},aN:function(){return l},kc:function(){return d},s6:function(){return i}});var n=t(7277);const l=()=>n.A.get("/api/department/sync"),s=()=>n.A.get("/api/department/list"),r=a=>n.A.get("/api/staff/list",{params:a}),u=a=>n.A.get("/api/groups/list",{params:a}),d=a=>n.A.get("/api/groups/sync",{params:a}),i=a=>n.A.get("/api/customers/list",{params:a}),o=a=>n.A.get("/api/customers/sync",{params:a})},2853:function(a,e,t){t.r(e),t.d(e,{default:function(){return P}});var n=t(6768),l=t(4232),s=t(144),r=t.p+"img/taglogo.e43b5dbc.svg",u=t(6010),d=t(7894),i=t(7875),o=(t(8298),t(7694)),c=t(1576),_=t.n(c);const g={class:"filter-box"},v={class:"filter-item"},m={class:"mr10"},p={class:"filter-item",style:{"justify-content":"right"}},k={class:"container"},f={class:"left-block"},y={class:"header-box mt12"},b={class:"fl-fc"},x={class:"wz"},h={class:"list margin-bottom-16 self-header-two fx-ac",style:{"justify-content":"space-between","margin-top":"12px"}},w={class:"fx-ac update-box"},L={key:0,class:"lefts_sizes"},C={class:"qunfa",style:{display:"flex","align-items":"center"}},I=["src"],K={key:1,src:r,alt:""},R={class:"qunfa-box"},W={class:"qunfa_name"},X={style:{color:"#faad14"}},z={key:2,class:"wk-black-65-text"},A={key:3,class:"wk-black-65-text"},F={key:5,class:"tages_wid"},S={style:{width:"200px"}},E={class:"nowrap flex"},O={class:"nowrap",style:{color:"#1890ff",width:"30px"}},j={key:2};var Q={__name:"index",setup(a){const e=(0,s.Kh)({size:20,page:1,name:"",member_name:"",tagNames:[],remark_yes:-1,sort:1,normal_status:""}),t=(0,s.Kh)({type:0,contain_tag:[],contain_tag_keys:[],contain_tag_map:[],exclude_tag:[],exclude_tag_map:[]}),r=[{dataIndex:"external_name",key:"external_name",title:"客户昵称",scopedSlots:{customRender:"external_name"},fixed:"left"},{title:"流失状态",dataIndex:"add_status",key:"add_status",scopedSlots:{customRender:"add_status"}},{title:"所属员工",dataIndex:"staff_user_name",key:"staff_user_name",width:120,scopedSlots:{customRender:"staff_name_slot"}},{title:"添加时间",dataIndex:"add_time",key:"add_time"},{title:"客户标签",key:"tag_data",dataIndex:"tag_data",scopedSlots:{customRender:"tag_data"}}],c=(0,s.KR)(""),Q=(0,s.KR)("b"),D=(0,s.KR)(""),N=(0,s.KR)(!1),P=(0,s.KR)([]),Y=(0,s.Kh)({total:0,current:1,pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]}),q=(0,s.Kh)({keyword:""}),B=(0,s.KR)(0),H=(0,s.KR)(!1),M=(0,s.KR)(!1),T=(0,s.KR)([]);function U(a){let e=parseInt((new Date).getTime()/1e3)+"",t="",n="";return n=1*e-+a,n<=60?t=n+"秒前 ":n>60&&n<=3660?t=parseInt(n/60)+"分钟前 ":n>3660&&n<=86400?t=parseInt(n/3600)+"小时前 ":n>86400&&(t=parseInt(n/86400)+"天前 "),t}const J=()=>{ta()},V=(a,e)=>a?a.length>e?a.substring(0,e)+"..":a:"",G=(0,s.KR)(0),Z=()=>{0==G.value&&(G.value=1,H.value=!0,(0,i.LB)({}).then((a=>{G.value=0,H.value=!1,o.Ay.success("更新成功")})))};(0,n.sV)((()=>{na()}));const $=(0,s.KR)(0),aa=()=>{$.value=(new Date).getTime()/1e3,e.page=1,ta()},ea=()=>{t.type=0,t.contain_tag=[],t.contain_tag_keys=[],t.contain_tag_map=[],t.exclude_tag=[],t.exclude_tag_map=[],T.value=[],D.value="",q.keyword="",aa()},ta=()=>{P.value=[],Y.total=1,Y.current=1,na()},na=()=>{N.value=!0;let a={page:Y.current,size:Y.pageSize};q.keyword=q.keyword.trim(),q.keyword&&(a.keyword=q.keyword),"a"===Q.value&&(a.add_time=_()().subtract(6,"day").format("YYYY-MM-DD HH:mm:ss")),(0,i.s6)(a).then((a=>{P.value=a.data.items||[],c.value=a.data.last_sync_time||"",Y.total=Number(a.data.total),B.value=a.data.total})).finally((()=>{N.value=!1}))},la=a=>{Y.current=a.current,Y.pageSize=a.pageSize,na()};return(a,e)=>{const t=(0,n.g2)("a-input"),i=(0,n.g2)("a-button"),o=(0,n.g2)("a-radio-button"),_=(0,n.g2)("a-radio-group"),D=(0,n.g2)("a-tooltip"),T=(0,n.g2)("a-tag"),G=(0,n.g2)("a-popover"),$=(0,n.g2)("a-table");return(0,n.uX)(),(0,n.Wv)(d.A,{title:"客户列表"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",g,[(0,n.Lk)("div",v,[e[2]||(e[2]=(0,n.Lk)("label",null,"搜索客户：",-1)),(0,n.Lk)("div",m,[(0,n.bF)(t,{style:{width:"100%"},placeholder:"请输入客户昵称搜索",allowClear:"",onPressEnter:aa,value:q.keyword,"onUpdate:value":e[0]||(e[0]=a=>q.keyword=a)},null,8,["value"])])]),e[5]||(e[5]=(0,n.Lk)("div",{class:"filter-item"},null,-1)),(0,n.Lk)("div",p,[(0,n.bF)(i,{onClick:aa,type:"primary"},{default:(0,n.k6)((()=>e[3]||(e[3]=[(0,n.eW)("搜索")]))),_:1}),(0,n.bF)(i,{onClick:ea,class:"ml8"},{default:(0,n.k6)((()=>e[4]||(e[4]=[(0,n.eW)("重置")]))),_:1})])]),(0,n.Lk)("div",k,[(0,n.Lk)("div",f,[(0,n.Lk)("div",y,[(0,n.Lk)("div",b,[(0,n.Lk)("span",x,[(0,n.bF)(_,{value:Q.value,"onUpdate:value":e[1]||(e[1]=a=>Q.value=a),"button-style":"solid",style:{"margin-right":"4px"},onChange:J},{default:(0,n.k6)((()=>[(0,n.bF)(o,{value:"a",disabled:M.value},{default:(0,n.k6)((()=>e[6]||(e[6]=[(0,n.eW)(" 近七日 ")]))),_:1},8,["disabled"]),(0,n.bF)(o,{value:"b",style:{width:"74px","text-align":"center"}},{default:(0,n.k6)((()=>e[7]||(e[7]=[(0,n.eW)(" 全部 ")]))),_:1})])),_:1},8,["value"]),(0,n.eW)(" "+(0,l.v_)(M.value||"a"!=Q.value?"共":"共新增")+(0,l.v_)(B.value||0)+"个客户 ",1)])]),(0,n.Lk)("div",h,[(0,n.Lk)("div",w,[(0,n.Lk)("div",null,[c.value?((0,n.uX)(),(0,n.CE)("span",L," 上次更新时间："+(0,l.v_)(U(c.value)),1)):(0,n.Q3)("",!0)]),(0,n.bF)(i,{loading:H.value,class:"lefts btn-update",onClick:Z},{icon:(0,n.k6)((()=>[(0,n.bF)((0,s.R1)(u.A),{class:"update-icon"})])),default:(0,n.k6)((()=>[(0,n.eW)(" "+(0,l.v_)(H.value?"更新中":"更新数据"),1)])),_:1},8,["loading"])])])]),(0,n.bF)($,{class:"mt16",loading:N.value,"data-source":P.value,columns:r,pagination:Y,onChange:la},{bodyCell:(0,n.k6)((({column:a,text:e,record:t})=>["external_name"===a.dataIndex?((0,n.uX)(),(0,n.Wv)(D,{key:0,overlayClassName:"user-info-tooltip"},{title:(0,n.k6)((()=>[(0,n.Lk)("div",null,"客户备注："+(0,l.v_)(t.staff_remark),1),(0,n.Lk)("div",null,"外部联系人ID："+(0,l.v_)(t.external_userid),1)])),default:(0,n.k6)((()=>[(0,n.Lk)("div",C,[t.avatar?((0,n.uX)(),(0,n.CE)("img",{key:0,src:t.avatar,style:{width:"32px",height:"32px","margin-right":"8px"},alt:""},null,8,I)):((0,n.uX)(),(0,n.CE)("img",K)),(0,n.Lk)("div",R,[(0,n.Lk)("div",null,[(0,n.Lk)("span",W,(0,l.v_)(V(t.external_name,7)),1),(0,n.Lk)("span",X,(0,l.v_)(""==t.corp_name?"@微信":"@"+t.corp_name),1)])])])])),_:2},1024)):(0,n.Q3)("",!0),"add_status"===a.dataIndex?((0,n.uX)(),(0,n.Wv)(T,{key:1,color:"0"==t.add_status?"volcano":"green"},{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(0==t.add_status?"已流失":"未流失"),1)])),_:2},1032,["color"])):(0,n.Q3)("",!0),"staff_name_slot"===a.dataIndex?((0,n.uX)(),(0,n.CE)("span",z,(0,l.v_)(t.staff_user_name),1)):(0,n.Q3)("",!0),"add_time"===a.dataIndex?((0,n.uX)(),(0,n.CE)("span",A,(0,l.v_)(t.add_time),1)):(0,n.Q3)("",!0),"source"===a.dataIndex?((0,n.uX)(),(0,n.CE)(n.FK,{key:4},[(0,n.eW)((0,l.v_)(t.add_way)+" "+(0,l.v_)(t.state&&t.state.name?"【"+t.state.name+"】":""),1)],64)):(0,n.Q3)("",!0),"tag_data"===a.dataIndex?((0,n.uX)(),(0,n.CE)("span",F,[t.tag_data.length>1?((0,n.uX)(),(0,n.Wv)(G,{key:0,overlayStyle:{zIndex:998}},{content:(0,n.k6)((()=>[(0,n.Lk)("div",S,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.tag_data.slice(1,t.tag_data.length),(a=>((0,n.uX)(),(0,n.Wv)(T,{style:{"white-space":"pre-wrap","margin-bottom":"5px"},color:"blue",key:a.tag_id},{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(a.tag_name),1)])),_:2},1024)))),128))])])),default:(0,n.k6)((()=>[(0,n.Lk)("div",E,[(0,n.bF)(T,{color:"blue",style:{"margin-bottom":"0"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(t.tag_data[0]&&t.tag_data[0].tag_name.length>10?t.tag_data[0].tag_name.substring(0,10)+"...":t.tag_data[0].tag_name),1)])),_:2},1024),(0,n.Lk)("div",O," +"+(0,l.v_)(t.tag_data.length-1),1)])])),_:2},1024)):1==t.tag_data.length?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[t.tag_data.length?((0,n.uX)(),(0,n.Wv)(T,{key:0,color:"blue",style:{"margin-bottom":"0"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(t.tag_data[0]&&t.tag_data[0].tag_name.length>10?t.tag_data[0].tag_name.substring(0,10)+"...":t.tag_data[0].tag_name),1)])),_:2},1024)):(0,n.Q3)("",!0)],64)):((0,n.uX)(),(0,n.CE)("div",j," - "))])):(0,n.Q3)("",!0)])),_:1},8,["loading","data-source","pagination"])])])])),_:1})}}},D=t(1241);const N=(0,D.A)(Q,[["__scopeId","data-v-44756889"]]);var P=N}}]);
//# sourceMappingURL=508.41503bca.js.map