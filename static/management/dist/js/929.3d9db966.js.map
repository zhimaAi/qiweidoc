{"version":3,"file":"js/929.3d9db966.js","mappings":"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","sources":["webpack://zmwk_session_archive/./node_modules/@ant-design/icons-svg/es/asn/QuestionCircleFilled.js","webpack://zmwk_session_archive/./node_modules/@ant-design/icons-vue/es/icons/QuestionCircleFilled.js","webpack://zmwk_session_archive/./node_modules/@ant-design/icons-svg/es/asn/RedoOutlined.js","webpack://zmwk_session_archive/./node_modules/@ant-design/icons-vue/es/icons/RedoOutlined.js","webpack://zmwk_session_archive/./src/views/sessionStatistics/group.vue","webpack://zmwk_session_archive/./src/views/sessionStatistics/group.vue?c731"],"sourcesContent":["// This icon file is generated automatically.\nvar QuestionCircleFilled = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 708c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zm62.9-219.5a48.3 48.3 0 00-30.9 44.8V620c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-21.5c0-23.1 6.7-45.9 19.9-64.9 12.9-18.6 30.9-32.8 52.1-40.9 34-13.1 56-41.6 56-72.7 0-44.1-43.1-80-96-80s-96 35.9-96 80v7.6c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V420c0-39.3 17.2-76 48.4-103.3C430.4 290.4 470 276 512 276s81.6 14.5 111.6 40.7C654.8 344 672 380.7 672 420c0 57.8-38.1 109.8-97.1 132.5z\" } }] }, \"name\": \"question-circle\", \"theme\": \"filled\" };\nexport default QuestionCircleFilled;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport QuestionCircleFilledSvg from \"@ant-design/icons-svg/es/asn/QuestionCircleFilled\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar QuestionCircleFilled = function QuestionCircleFilled(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": QuestionCircleFilledSvg\n  }), null);\n};\n\nQuestionCircleFilled.displayName = 'QuestionCircleFilled';\nQuestionCircleFilled.inheritAttrs = false;\nexport default QuestionCircleFilled;","// This icon file is generated automatically.\nvar RedoOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z\" } }] }, \"name\": \"redo\", \"theme\": \"outlined\" };\nexport default RedoOutlined;\n","import { createVNode as _createVNode } from \"vue\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport RedoOutlinedSvg from \"@ant-design/icons-svg/es/asn/RedoOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar RedoOutlined = function RedoOutlined(props, context) {\n  var p = _objectSpread({}, props, context.attrs);\n\n  return _createVNode(AntdIcon, _objectSpread({}, p, {\n    \"icon\": RedoOutlinedSvg\n  }), null);\n};\n\nRedoOutlined.displayName = 'RedoOutlined';\nRedoOutlined.inheritAttrs = false;\nexport default RedoOutlined;","<template>\n    <MainLayout title=\"群聊统计\">\n        <div class=\"zm-main-content\">\n            <div>\n                <a @click=\"showStaffModal\">设置统计员工</a>\n                <span v-if=\"statStaffs.length > 0\" class=\"zm-tip-info\">（已设置{{ statStaffs.length }}名员工）</span>\n            </div>\n            <div class=\"filter-box mt16\">\n                <div class=\"filter-item\">\n                    <span class=\"item-label\">选择时间：</span>\n                    <div class=\"item-body\">\n                        <a-select v-model:value=\"filterData.year\"\n                                  @change=\"changeDefaultValue\"\n                                  style=\"width: 80px;\">\n                            <a-select-option :value=\"1\">今年</a-select-option>\n                            <a-select-option :value=\"2\">去年\n                            </a-select-option>\n                        </a-select>\n                        <a-select v-model:value=\"filterData.month\"\n                                  @change=\"changeDefaultValue\"\n                                  style=\"width: 80px;\">\n                            <a-select-option\n                                v-for=\"i in 12\"\n                                :value=\"i\"\n                                :key=\"i\">{{ i }}月\n                            </a-select-option>\n                        </a-select>\n                    </div>\n                </div>\n                <div class=\"filter-item\">\n                    <span class=\"item-label\">选择日期：</span>\n                    <div class=\"item-body\">\n                        <a-radio-group v-model:checked=\"filterData.dateType\" @change=\"dateTypeChange\">\n                            <a-radio-button :value=\"1\">今天</a-radio-button>\n                            <a-radio-button :value=\"2\">昨天</a-radio-button>\n                            <a-radio-button :value=\"0\">自定义</a-radio-button>\n                        </a-radio-group>\n                        <a-date-picker\n                            ref=\"customDateRef\"\n                            style=\"width: 160px;\"\n                            class=\"ml8\"\n                            v-model:value=\"filterData.date\"\n                            @change=\"dateChange\"\n                            :disabled-date=\"disabledDate\"\n                            format=\"YYYY-MM-DD\"></a-date-picker>\n                    </div>\n                </div>\n                <div class=\"filter-item\">\n                    <span class=\"item-label\">所属员工：</span>\n                    <div class=\"item-body\">\n                        <!--                    <ASelectStaff :key=\"filterStaffKey\" :maxTagCount=\"1\" @change=\"filterStaffChange\"/>-->\n                    </div>\n                </div>\n                <div class=\"filter-item\">\n                    <a-button type=\"primary\" @click=\"search\">搜 索</a-button>\n                    <a-button @click=\"reset\" class=\"ml4\">重 置</a-button>\n                </div>\n            </div>\n            <div class=\"zm-flex-between\">\n                <div class=\"filter-box\">\n                    <div class=\"filter-item\" v-if=\"filterData.dateType == 1\" style=\"margin-bottom: 0;\">\n                        <span class=\"item-label\" style=\"width: 100px;\">统计截止时间：</span>\n                        <div class=\"item-body\">\n                            {{ statDate || \"--\" }} <a class=\"ml16\" @click=\"updateStatData\">\n                            <RedoOutlined/>\n                            更新</a>\n                        </div>\n                    </div>\n                </div>\n                <a-button @click=\"exportData\" :loading=\"exporting\">导出</a-button>\n            </div>\n            <div class=\"table-box mt16\">\n                <a-table :loading=\"loading\"\n                         :data-source=\"list\"\n                         :columns=\"columns\"\n                         :scroll=\"{x:1300}\"\n                         :pagination=\"pagination\"\n                         @change=\"tableChange\"\n                >\n                    <template #headerCell=\"{ column }\">\n                        <template v-if=\"'group_no' === column.dataIndex\">\n                            <a-tooltip>\n                                <template #title>\n                                    <span>负责群：该员工所在的群聊数</span><br>\n                                    <span>今日新增：今日新加入的群聊</span>\n                                </template>\n                                负责总群数/今日新增\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                        <template v-else-if=\"'active_group_no' === column.dataIndex\">\n                            <a-tooltip>\n                                <template #title>\n                                    <span>活跃群：客户发了消息的群</span><br>\n                                    <span>回复群：活跃群聊中，回复了消息的群聊</span>\n                                </template>\n                                活跃群/回复群\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                        <template v-else-if=\"'staff_msg_no' === column.dataIndex\">\n                            <a-tooltip>\n                                <template #title>\n                                    <span>总消息：员工所在的群聊的全部员工发送的消息</span><br>\n                                    <span>员工发送：员工所在的群聊中该员工发送的消息数</span>\n                                </template>\n                                总消息/员工发送\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                        <template v-else-if=\"'no_reply_group_no' === column.dataIndex\">\n                            <a-tooltip title=\"员工所在的群聊活跃群聊中未回复消息的群聊数以及占比\">\n                                未回复/未回复率\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                        <template v-else-if=\"'at_rate_avg' === column.dataIndex\">\n                            <a-tooltip\n                                :title=\"`${config.group_at_msg_reply_sec}分钟内回复的总轮次/群的总轮次之和，这里轮次是客户发起，员工回复算一轮`\">\n                                @后{{ config.group_at_msg_reply_sec }}分钟回复率\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                        <template v-else-if=\"'rate_avg' === column.dataIndex\">\n                            <a-tooltip\n                                :title=\"`${config.msg_reply_sec}分钟内回复的总轮次/群的总轮次之和，这里轮次是客户发起，所属员工回复算一轮`\">\n                                {{ config.msg_reply_sec }}分钟回复率\n                                <QuestionCircleFilled/>\n                            </a-tooltip>\n                        </template>\n                    </template>\n\n                    <template #bodyCell=\"{column, text, record}\">\n                        <template v-if=\"'at_rate_avg' === column.dataIndex\">\n                            <a-tooltip\n                                v-if=\"!whetherStatCurrentDate\"\n                                overlayClassName=\"stat-config-overlay\">\n                                <template #title>\n                                    <div>统计时间</div>\n                                    <div>\n                                        <div v-for=\"(desc,i) in statConfig.descText\">{{ desc }}</div>\n                                    </div>\n                                </template>\n                                <span class=\"no-stat-tag\">未统计</span>\n                            </a-tooltip>\n                            <a v-else @click=\"linkPath('/workQualityStat/replyRateDetail',record)\">{{ text }}</a>\n                        </template>\n                        <template v-else-if=\"'rate_avg' === column.dataIndex\">\n                            <a-tooltip\n                                v-if=\"!whetherStatCurrentDate\"\n                                overlayClassName=\"stat-config-overlay\">\n                                <template #title>\n                                    <div>统计时间</div>\n                                    <div>\n                                        <div v-for=\"(desc,i) in statConfig.descText\">{{ desc }}</div>\n                                    </div>\n                                </template>\n                                <span class=\"no-stat-tag\">未统计</span>\n                            </a-tooltip>\n                            <a v-else @click=\"linkPath('/workQualityStat/replyRateDetail',record)\">{{ text }}</a>\n                        </template>\n                        <template v-else-if=\"'groupTotal' === column.dataIndex\">\n                            <a @click=\"linkPath('/workQualityStat/staffAllOrTodayGroup',record)\">{{ text }} / {{ record.today_allot }}</a>\n                        </template>\n                        <template v-else-if=\"'active_group_no' === column.dataIndex\">\n                            <a @click=\"linkPath('/workQualityStat/staffActiveReplyGroup',record)\">{{ text }} / {{ record.reply_group_no }}</a>\n                        </template>\n                        <template v-else-if=\"'staff_msg_no' === column.dataIndex\">\n                            {{ record.all_stf_msg_no }} / {{ record.staff_msg_no }}\n                        </template>\n                        <template v-else-if=\"'no_reply_group_no' === column.dataIndex\">\n                            <a @click=\"linkPath('/workQualityStat/staffUnreplyGroup',record)\">{{ text }}</a> /\n                            {{ record.noreply_rate }}\n                        </template>\n                    </template>\n                </a-table>\n            </div>\n        </div>\n\n        <a-modal title=\"添加统计员工\" v-model=\"staffModal.visible\" @ok=\"saveStatStaff\"\n                 :confirm-loading=\"staffModal.saving\">\n            <a-alert type=\"info\"\n                     message=\"添加统计的员工若取消统计，当天的统计结果会被删除，取消的时间内之后都不会统计，重新添加从添加的那天才统计\"/>\n            <div class=\"stat-staff-modal mt16\">\n                <div class=\"form-item\">\n                    <span class=\"item-tit\">统计员工：</span>\n                </div>\n            </div>\n        </a-modal>\n    </MainLayout>\n</template>\n\n<script setup>\nimport {ref, reactive, onMounted} from 'vue';\nimport {useRouter} from 'vue-router';\nimport dayjs from 'dayjs';\nimport {message} from 'ant-design-vue';\nimport {RedoOutlined, QuestionCircleFilled} from '@ant-design/icons-vue';\nimport MainLayout from \"@/components/mainLayout.vue\";\n\nconst router = useRouter()\nconst columns = [\n    {\n        title: \"所属员工\",\n        dataIndex: \"name\",\n        width: 120,\n    },\n    {\n        //title: \"所在总群数/今日新增\",\n        dataIndex: \"group_no\",\n        width: 80,\n    },\n    {\n        //title: \"活跃群聊数\",\n        dataIndex: \"active_group_no\",\n        width: 80,\n    },\n    {\n        //title: \"发送消息数\",\n        dataIndex: \"staff_msg_no\",\n        width: 80,\n    },\n    {\n        //title: \"未回复群聊\",\n        dataIndex: \"no_reply_group_no\",\n        width: 100,\n    },\n    {\n        //title: \"@后X分钟回复率\",\n        dataIndex: \"at_rate_avg\",\n        width: 100,\n    },\n    {\n        //title:  \"分钟回复率\",\n        dataIndex: \"rate_avg\",\n        width: 80,\n    },\n]\nconst defaultDate = dayjs()\nconst filterDataDefault = {\n    year: 1,\n    month: 1,\n    dateType: 1,\n    date: undefined,\n    staffs: [],\n    order: \"\"\n}\nconst loading = ref(false)\nconst updateing = ref(false)\nconst exporting = ref(false)\nconst statStaffs = ref([])\nconst statDate = ref('')\nconst filterStaffKey = ref(1)\nconst list = ref([])\nconst whetherStatCurrentDate = ref(true)\nconst filterData = reactive({\n    ...filterDataDefault\n})\nconst config = reactive({\n    group_at_msg_reply_sec: \"\",\n    msg_reply_sec: \"\",\n    last_stat_time: \"\",\n    last_stat_date: \"\",\n})\nconst pagination = reactive({\n    current: 1,\n    page: 1,\n    pageSize: 10,\n    total: 0,\n    pageSizeOptions: ['10', '20', '50', '100'],\n    showQuickJumper: true,\n    showSizeChanger: true,\n})\nconst staffModal = reactive({\n    visible: false,\n    saving: false,\n    staffs: [],\n})\n\nonMounted(() => {\n    init()\n})\n\nasync function init() {\n    filterDataInit()\n    loadData()\n    loadStatStaff()\n}\n\nfunction loadStatStaff() {\n    // getStatStaffs().then(res => {\n    //     let list = res.data || []\n    //     list.map(item => {\n    //         item.staff_id = item._id\n    //     })\n    //     statStaffs.value = list\n    // })\n}\n\nfunction filterDataInit() {\n    filterData.year = 1\n    filterData.month = Number(dayjs().format(\"MM\"))\n}\n\nfunction filterStaffChange(staff) {\n    filterData.staffs = staff\n    search()\n}\n\nfunction reset() {\n    filterData = Object.assign(data, filterDataDefault);\n    filterStaffKey.value += 1\n    filterDataInit()\n    search()\n}\n\nfunction search() {\n    pagination.current = 1\n    loadData()\n}\n\nfunction loadData() {\n    //loading.value = true\n    let params = getFilterData()\n    whetherStatCurrentDate.value = whetherStatCurrentDateRun(params.date_no)\n    // groupMemberStat(params).then(res => {\n    //     statDate = dayjs(res.data.statistic_time * 1000).format(\"YYYY-MM-DD HH:mm\")\n    //     let list = res.data.list || []\n    //     let config = res.data.stat_conf || {}\n    //     config.group_at_msg_reply_sec = config.group_at_msg_reply_sec / 60\n    //     config.msg_reply_sec = config.msg_reply_sec / 60\n    //     config.last_stat_date = moment(config.last_stat_time * 1000).format(\"YYYY-MM-DD HH:mm\")\n    //     this.config = config\n    //     list.map(item => {\n    //         item.msg_total = Number(item.cst_msg_no) + Number(item.staff_msg_no)\n    //         item.rate_avg = computedRate(item.rate_avg, 1)\n    //         item.at_rate_avg = computedRate(item.at_rate_avg, 1)\n    //         item.reply_group_no = Number(item.active_group_no) - Number(item.no_reply_group_no)\n    //         if (item.noreply_rate > 0) {\n    //             item.noreply_rate = (item.noreply_rate * 100).toFixed(2)+'%'\n    //         }\n    //     })\n    //     this.list = list\n    //     this.pagination.total = Number(res.data.count)\n    // }).finally(res => {\n    //     this.loading = false\n    // })\n}\n\nfunction whetherStatCurrentDateRun(dateStr) {\n    try {\n        let weekday = dayjs(dateStr).weekday()\n        return statConfig.weeks.includes(weekday)\n    } catch (e) {\n    }\n    return true\n}\n\nfunction getFilterData() {\n    let params = {\n        page: pagination.current,\n        size: pagination.pageSize\n    }\n    switch (filterData.dateType) {\n        case 1:\n            params.date_no = dayjs().format(\"YYYYMMDD\")\n            break\n        case 2:\n            params.date_no = dayjs().subtract(1, \"days\").format(\"YYYYMMDD\")\n            break\n        case 0:\n            if (filterData.date) {\n                params.date_no = filterData.date.format(\"YYYYMMDD\")\n            }\n            break\n    }\n    if (filterData.staffs.length) {\n        params.user_ids = filterData.staffs.map(i => i.user_id).toString()\n    }\n    if (filterData.order) {\n        params.order = filterData.order\n    }\n    return params\n}\n\nfunction tableChange(pagination, _, sorter) {\n    // if (sorter.field && sorter.order) {\n    //     columns.value.map(item => {\n    //         if (item.dataIndex === sorter.field) {\n    //             item.sortOrder = sorter.order\n    //         } else {\n    //             item.sortOrder = false\n    //         }\n    //     })\n    //     this.filterData.order = `${sorter.field} ${sorter.order == 'ascend' ? 'ASC' : 'DESC'}`\n    // } else {\n    //     this.columns.map(item => item.sortOrder = false)\n    //     this.filterData.order = \"\"\n    // }\n    // this.pagination = pagination\n    // this.loadData()\n}\n\nfunction disabledDate(current) {\n    let year = filterData.year == 1 ? Number(moment().format(\"YYYY\")) : Number(moment().subtract(1, \"year\").format(\"YYYY\"))\n    return Number(current.format(\"YYYY\")) != year || Number(current.format(\"MM\")) != filterData.month\n}\n\nfunction dateChange() {\n    filterData.dateType = 0\n    search()\n}\n\nfunction dateTypeChange() {\n    if (filterData.dateType === 0) {\n        $refs.customDateRef.focus()\n        filterData.date = moment()\n        search()\n    } else {\n        filterData.date = undefined\n        filterDataInit()\n        search()\n    }\n}\n\nfunction changeDefaultValue() {\n    let year = filterData.year == 1 ? Number(moment().format(\"YYYY\")) : Number(moment().subtract(1, \"year\").format(\"YYYY\"))\n    let month = filterData.month < 10 ? '0' + filterData.month : filterData.month\n    filterData.date = moment(`${year}-${month}-01`)\n    filterData.dateType = 0\n    search()\n}\n\nfunction linkPath(path, record) {\n    const routeUrl = router.resolve({\n        path: path,\n        query: {\n            staff_user_id: record.staff_user_id,\n            filter_date: getFilterData().date_no || \"\",\n            group_at_msg_reply_sec: config.group_at_msg_reply_sec,\n            msg_reply_sec: config.msg_reply_sec,\n        }\n    })\n    window.open(routeUrl.href, '_blank');\n}\n\nfunction disabledLastYear() {\n    return dayjs().format(\"YYYY\") <= 2024\n}\n\nfunction updateStatData() {\n    if (updateing.value) {\n        return\n    }\n    updateing.value = true\n    // groupStatOnce().then(res => {\n    //     this.search()\n    // }).finally(() => {\n    //     this.updateing = false\n    // })\n}\n\nfunction exportData() {\n    if (pagination.total < 1) {\n        return message.error(\"暂无数据\")\n    }\n    exporting.value = true\n    let params = getFilterData()\n    params.size = 5000\n    // groupMemberStat(params).then(res => {\n    //     let list = res.data.list || []\n    //     list.map(item => {\n    //         item.msg_total = Number(item.cst_msg_no) + Number(item.staff_msg_no)\n    //         item.rate_avg = computedRate(item.rate_avg, 1)\n    //         item.at_rate_avg = computedRate(item.at_rate_avg, 1)\n    //         item.reply_group_no = Number(item.active_group_no) - Number(item.no_reply_group_no)\n    //         if (item.noreply_rate > 0) {\n    //             item.noreply_rate = (item.noreply_rate * 100).toFixed(2)+'%'\n    //         }\n    //     })\n    //     const head =  `员工,负责群,今日新增,活跃群,回复群,员工消息,总消息,未回复,未回复率,@后${ this.config.group_at_msg_reply_sec }分钟回复率,${this.config.msg_reply_sec}分钟回复率\\n`\n    //     const fields = [\n    //         \"name\", \"group_no\", \"today_allot\", \"active_group_no\", \"reply_group_no\",\"staff_msg_no\", \"msg_total\", \"no_reply_group_no\", \"noreply_rate\", \"at_rate_avg\", \"rate_avg\"\n    //     ]\n    //     tableToExcel(head, list, fields, \"员工群聊详情.csv\");\n    // }).finally(() => {\n    //     exporting.value = false\n    // })\n}\n\nfunction showStaffModal() {\n    staffModal.staffs = this.statStaffs\n    staffModal.visible = true\n}\n\nfunction statStaffChange(val) {\n    staffModal.staffs = val\n}\n\nfunction saveStatStaff() {\n    staffModal.saving = true\n    // let userids = this.staffModal.staffs.map(i => i.user_id).filter(Boolean).join(',')\n    // saveStatStaff({\n    //     user_ids: userids\n    // }).then(res => {\n    //     this.statStaffs = this.staffModal.staffs\n    //     this.$message.success('已保存')\n    //     this.staffModal.visible = false\n    // }).finally(() => {\n    //     this.staffModal.saving = false\n    // })\n}\n</script>\n\n<style scoped lang=\"less\">\n.zm-main-content {\n    min-height: 86vh;\n}\n\n.filter-box {\n    display: flex;\n    flex-wrap: wrap;\n\n    .filter-item:last-child {\n        margin-right: 0;\n    }\n\n    .filter-item {\n        display: flex;\n        align-items: center;\n        margin: 0 16px 16px 0;\n\n        .item-label {\n            font-size: 14px;\n            font-weight: 400;\n            color: #262626;\n            width: 70px;\n            flex-shrink: 0;\n\n            &.not_allot {\n                width: auto;\n                padding-left: 40px;\n                margin-bottom: 0;\n                cursor: pointer;\n            }\n\n            .link {\n                color: #2475fc;\n            }\n        }\n\n        .item-body {\n            flex: 1;\n        }\n    }\n}\n\n.table-box {\n    :deep(.ant-table) {\n        font-size: 12px;\n    }\n}\n\n.no-stat-tag {\n    font-size: 14px;\n    font-weight: 500;\n    color: #8C8C8C;\n    cursor: default;\n}\n</style>\n","import script from \"./group.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./group.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./group.vue?vue&type=style&index=0&id=410452ba&scoped=true&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-410452ba\"]])\n\nexport default __exports__"],"names":["QuestionCircleFilled","_objectSpread","target","i","arguments","length","source","Object","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","props","context","p","attrs","_createVNode","AntdIcon","QuestionCircleFilledSvg","displayName","inheritAttrs","RedoOutlined","RedoOutlinedSvg","router","useRouter","columns","title","dataIndex","width","filterDataDefault","dayjs","year","month","dateType","date","undefined","staffs","order","loading","ref","updateing","exporting","statStaffs","statDate","filterStaffKey","list","whetherStatCurrentDate","filterData","reactive","config","group_at_msg_reply_sec","msg_reply_sec","last_stat_time","last_stat_date","pagination","current","page","pageSize","total","pageSizeOptions","showQuickJumper","showSizeChanger","staffModal","visible","saving","async","init","filterDataInit","loadData","loadStatStaff","Number","format","reset","assign","data","search","params","getFilterData","whetherStatCurrentDateRun","date_no","dateStr","weekday","statConfig","weeks","includes","e","size","subtract","user_ids","map","user_id","toString","tableChange","_","sorter","disabledDate","moment","dateChange","dateTypeChange","$refs","customDateRef","focus","changeDefaultValue","linkPath","path","record","routeUrl","resolve","query","staff_user_id","filter_date","window","open","href","updateStatData","exportData","message","error","showStaffModal","this","saveStatStaff","onMounted","__exports__"],"sourceRoot":""}